<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Three Bees Animation</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <header>
      <div class="content-fit">
        <div class="logo">Tokio</div>
        <nav>
          <ul>
            <li>Contacts</li>
            <li>Category</li>
            <li>Login</li>
          </ul>
        </nav>
      </div>
    </header>
    <div class="section" id="banner">
      <div class="content-fit">
        <div class="title" data-before="WEBSITEDESIGN">3D ANIMATION</div>
      </div>
      <img src="img/peonies2.png" class="decorate img1" alt="" />
      <img src="img/peonies1.png" class="decorate img2" alt="" />
    </div>
    <div class="section" id="intro">
      <div class="content-fit">
        <div class="number">01</div>
        <div class="des">
          <div class="title">3d animation design for website</div>
          <p>
            Lorem ipsum dolor sit, amet consectetur adipisicing elit.
            Voluptatibus voluptas a porro libero recusandae quae, aut ratione,
            incidunt laborum, necessitatibus similique enim doloremque ex.
            Laudantium obcaecati aspernatur doloremque illo beatae, maxime hic
            itaque consequatur nisi accusantium veritatis, voluptatem ratione!
            Placeat numquam nisi reiciendis harum quibusdam tempore eaque
            deleniti accusantium, veniam quae eos sed, asperiores laborum
            corporis odit mollitia consequatur adipisci? Quibusdam quis eos
            debitis non esse blanditiis laudantium rerum odit tempora? Corrupti
            maiores velit consequuntur cupiditate reiciendis similique provident
            repudiandae.
          </p>
        </div>
      </div>
    </div>
    <div class="section" id="description">
      <div class="content-fit">
        <div class="number">02</div>
        <div class="des">
          <div class="title">Tokio</div>
          <p>
            Lorem ipsum dolor sit, amet consectetur adipisicing elit.
            Voluptatibus voluptas a porro libero recusandae quae, aut ratione,
            incidunt laborum, necessitatibus similique enim doloremque ex.
            Laudantium obcaecati aspernatur doloremque illo beatae, maxime hic
            itaque consequatur nisi accusantium veritatis, voluptatem ratione!
            Placeat numquam nisi reiciendis harum quibusdam tempore eaque
            deleniti accusantium, veniam quae eos sed, asperiores laborum
            corporis odit mollitia consequatur adipisci? Quibusdam quis eos
            debitis non esse blanditiis laudantium rerum odit tempora? Corrupti
            maiores velit consequuntur cupiditate reiciendis similique provident
            repudiandae.
          </p>
        </div>
      </div>
      <img src="img/leaf.png" class="decorate img3" alt="" />
    </div>
    <div class="section" id="contact">
      <div class="content-fit">
        <div class="number">03</div>
        <div class="des">
          <div class="title">CONTACT</div>
          <table>
            <tr>
              <td>Email</td>
              <td>test@gmail.com</td>
            </tr>
            <tr>
              <td>Phone</td>
              <td>+841.231.235</td>
            </tr>
            <tr>
              <td>Website</td>
              <td>Tokio.com</td>
            </tr>
          </table>
          <div class="sign">Tokio</div>
        </div>
      </div>
    </div>
  </body>
  <div id="container3D"></div>
  <!-- <script type="module" src="app.js"></script> -->
  <script type="module">
    import * as THREE from "https://cdn.skypack.dev/three@0.129.0/build/three.module.js";
    import { GLTFLoader } from "https://cdn.skypack.dev/three@0.129.0/examples/jsm/loaders/GLTFLoader.js";
    import { gsap } from "https://cdn.skypack.dev/gsap";

    const camera = new THREE.PerspectiveCamera(
      10,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );
    camera.position.z = 13;

    const scene = new THREE.Scene();
    let bee;
    let mixer;
    const loader = new GLTFLoader();

    loader.load(
      "img/animated_bee.glb",
      function (gltf) {
        bee = gltf.scene;
        scene.add(bee);
        bee.scale.set(0.06, 0.06, 0.06);

        mixer = new THREE.AnimationMixer(bee);
        mixer.clipAction(gltf.animations[1]).play();
        modelMove();
      },
      function (xhr) {},
      function (error) {}
    );

    const renderer = new THREE.WebGLRenderer({ alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.getElementById("container3D").appendChild(renderer.domElement);

    // light
    const ambientLight = new THREE.AmbientLight("#eeede9", 1.1);
    scene.add(ambientLight);

    const topLight = new THREE.DirectionalLight("#eeede9", 1);
    topLight.position.set(500, 500, 500);
    scene.add(topLight);

    const reRender3D = () => {
      requestAnimationFrame(reRender3D);
      renderer.render(scene, camera);
      if (mixer) mixer.update(0.01);
    };
    reRender3D();

    let arrPositionModel = [
      {
        id: "banner",
        position: { x: 0, y: -1, z: 0 },
        rotation: { x: 0, y: 1.5, z: 0 },
      },
      {
        id: "intro",
        position: { x: 1, y: -1, z: -5 },
        rotation: { x: 0.5, y: -0.5, z: 0 },
      },
      {
        id: "description",
        position: { x: -1, y: -1, z: -5 },
        rotation: { x: 0, y: 0.5, z: 0 },
      },
      {
        id: "contact",
        position: { x: 0.8, y: -1, z: 0 },
        rotation: { x: 0.3, y: -0.5, z: 0 },
      },
    ];
    const modelMove = () => {
      const sections = document.querySelectorAll(".section");
      let currentSection;
      sections.forEach((section) => {
        const rect = section.getBoundingClientRect();
        if (rect.top <= window.innerHeight / 3) {
          currentSection = section.id;
        }
      });
      let position_active = arrPositionModel.findIndex(
        (val) => val.id == currentSection
      );
      if (position_active >= 0) {
        let new_coordinates = arrPositionModel[position_active];
        gsap.to(bee.position, {
          x: new_coordinates.position.x,
          y: new_coordinates.position.y,
          z: new_coordinates.position.z,
          duration: 3,
          ease: "power1.out",
        });
        gsap.to(bee.rotation, {
          x: new_coordinates.rotation.x,
          y: new_coordinates.rotation.y,
          z: new_coordinates.rotation.z,
          duration: 3,
          ease: "power1.out",
        });
      }
    };
    window.addEventListener("scroll", () => {
      if (bee) {
        modelMove();
      }
    });
    window.addEventListener("resize", () => {
      renderer.setSize(window.innerWidth, window.innerHeight);
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
    });
  </script>
</html>

<!-- //fixes -->
